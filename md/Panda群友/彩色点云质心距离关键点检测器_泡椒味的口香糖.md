# 彩色点云质心距离关键点检测器

## 0. 引言

关键点检测是计算机视觉和机器人应用(如3D重建)的基础，传统的点云主要通过RGB-D相机或激光雷达获得。大多数现有的关键点检测器仅考虑几何信息，而不能提取色彩丰富的关键点，这就限制了空间信息的有效利用。在2023 WACV论文"Centroid Distance Keypoint Detector for Colored Point Clouds"中，作者提出了一种新型的多模态点云关键点检测器，可以同时利用几何信息和颜色信息，对于三维重建、SLAM、点云配准领域的工作有所助力。

## 1. 论文信息

标题：Centroid Distance Keypoint Detector for Colored Point Clouds

作者：Hanzhe Teng, Dimitrios Chatziparaschis, Xinyue Kan, Amit K. Roy-Chowdhury, Konstantinos Karydis

来源：2023 IEEE/CVF Winter Conference on Applications of Computer Vision (WACV)

原文链接：https://arxiv.org/abs/2210.01298v1

代码链接：https://github.com/UCR-Robotics/CED_Detector

## 2. 摘要

关键点检测是许多计算机视觉和机器人应用的基础。尽管可以容易地获得彩色点云，但是大多数现有的关键点检测器仅提取几何显著的关键点，这可能妨碍打算(或有可能)利用颜色信息的系统的整体性能。为了促进这种系统的发展，我们提出了一种有效的多模态关键点检测器，它可以在彩色点云中提取几何显著和颜色显著的关键点。提出的质心距离(CED)关键点检测器包括直观和有效的显著性度量，即质心距离。其可以在3D空间和颜色空间中使用，以及多模态非最大值抑制算法，其可以在两个或更多模态中选择具有高显著性的关键点。所提出的显著性度量直接利用局部邻域中点的分布，并且不需要正态估计或特征值分解。我们在合成数据集和真实数据集上，针对最先进的关键点检测器，从可重复性和计算效率(即运行时间)方面评估了所提出的方法。结果表明，我们提出的CED关键点检测器需要最少的计算时间，同时获得高重复性。为了展示所提出的方法的一个潜在应用，我们进一步研究了彩色点云配准的任务。结果表明，我们提出的CED检测器在评估场景中优于最先进的手工制作和基于学习的关键点检测器。

## 3. 算法分析

现有方法通常应用各种算子来获得局部区域中的点法线、曲率和梯度，以及对应的协方差矩阵。而CED直接利用3D空间和颜色空间中的点分布和统计，且不需要做特征值分解。CED中分别考虑三维空间和颜色空间中的显著性度量，然后通过多模态非最大值抑制算法选择最佳响应。

### 3.1 3D空间中的质心距离

给定查询点pi，确定查询范围Ng，其邻域的几何质心可以表达为：

<img src="https://img-blog.csdnimg.cn/1b4fa12bd038425b9ea2594b67e66e8f.png" style="zoom:33%;" />

则查询点与邻域几何质心距离可以用L2范数表达为：

<img src="https://img-blog.csdnimg.cn/cd88f63822be43c1a22678050198699f.png" style="zoom: 25%;" />

图1(a)展示了一个角点示例，其中查询点(蓝色)在附近具有最大的响应，即到几何质心(红色)的最大距离。另一方面，图1(b)显示了一个平面，其中几何质心(红色)与查询点(蓝色)接近。显然，距离越大，它作为一个角点就越突出。

<img src="https://img-blog.csdnimg.cn/6ef374f71c5f4905aa627c37570b4247.png" style="zoom: 50%;" />

图1 查询点(蓝色)和所有点的几何形心(红色) (a)是位于拐角处的查询点，(b)是位于平坦表面中间的查询点。背景点(棕色)是从真实世界的数据集中提取的。

此外，为了便于匹配，考虑几何形心不变性。由于不管球体的平移和旋转，球体内部所有点的相对位置(距离和角度)都是固定的，因此所有点的几何质心相对于球体中心的相对位置也是固定的，即查询点位于球体中心。因此，从查询点到其几何质心的L2范数作为三维空间中的显著性度量，对旋转和平移具有不变性。这一点相较于ORB等旋转不变性的计算较为方便。

### 3.2 颜色空间中的质心距离

在颜色空间中，给定一个查询点pi，根据它的邻域点pj，可以计算颜色空间中的质心：

<img src="https://img-blog.csdnimg.cn/e8afc32d5d4242d88855e3732ce2eac0.png" style="zoom: 40%;" />

不同于几何空间，颜色空间距离采用L1范数，作者认为这样效率更高，并且颜色变化显著时，性能差异可以忽略不计：

<img src="https://img-blog.csdnimg.cn/ac0ae84b8b0e44aab2ca12354fb13845.png" style="zoom: 50%;" />

图2(a)展示了一个检测到的具有不同颜色属性的邻近点的关键点，球形区域内所有点对应的RGB颜色空间图如图2(b)所示。在这里，光度质心(红色)更接近于共享相似颜色的大多数点。查询点(黄色)具有较大的点到质心的距离，并且极有可能通过非极大值抑制。

<img src="https://img-blog.csdnimg.cn/ce6d73a384134f13adef990fa50efaa8.png" style="zoom:50%;" />

图2 (a)检测到的关键点位于具有显著颜色变化的位置(蓝色的球形区域)。(b)根据(a)中检测到的关键点，查询点(黄色)和光度质心(红色)的相邻点(蓝色)的RGB颜色空间图。

此外，在光度质心不变性方面。不管3D空间中的旋转和平移，在颜色空间中，球体中所有点的分布保持不变。因此，从查询点到颜色空间中采用的光度量质心的L1距离对于旋转和平移是不变的。

### 3.3 多模态非最大抑制

一旦同时获得了3D空间和颜色空间的显著性度量，下一步就是利用这两个度量来判断查询点是否为显著关键点。单响应的标准做法是检查当前响应是否为邻域最大值，作者将这个概念推广到多模态响应。具体的非极大值抑制算法如下所示，两个显著性测度相乘的等高线图如图4所示。

<img src="https://img-blog.csdnimg.cn/d740609bc29f4f769c452d43128a168b.png" style="zoom: 67%;" />

![](https://img-blog.csdnimg.cn/35398b93a7c847faaf5869fc0a16767f.png)

图3 两个显著性度量相乘的等值线图。浅蓝色区域反映几何突出的关键点，而浅红色区域反映颜色突出的关键点。

注意，多模态非极大值抑制的目标是同时提取几何突出(蓝色椭圆)和彩色突出(红色椭圆)的关键点，也就是说不能简单地删除那些在一个模态中表现不佳的点，因为位于平面中心的点可能包含丰富的纹理，而具有相同颜色邻居的点可能位于角落。因此，算法中的第5-7行用于通过与逻辑过滤那些既不是几何突出也不是颜色突出的点。在此步骤之后，丢弃红色和蓝色椭圆之外的点。下一步，算法中的第8-13行，通过考虑几何和颜色形态来选择具有最佳性能的点。

## 4. 实验

### 4.1 实验设置

在具体的实验中，作者分别设计了CED和CED-3D，CED-3D是CED的一个变种，只考虑了非彩色点云的几何信息。对比方案包括随机关键点、ISS、SIFT-3D、Harris-3D、Harris-6D以及基于学习的USIP。实验在第八代i7 CPU、Ubuntu 18.04、Quadro P1000 GPU上进行。。

数据集方面主要使用Redwood Synthetic、Redwood Scan、Tum和SUN3D。在预处理过程中，点云下采样到它们的最小分辨率，并且移除NaN点。表1显示了每个数据集的功能和关键参数。

表1 数据集特性比较

<img src="https://img-blog.csdnimg.cn/856bbd81131f4d59b0de40e37401829e.png" style="zoom: 50%;" />

### 4.2 定性评价

作者在Redwood Synthetic上进行了定性评估，比较结果如图4所示。可以得出三个主要观察结果：

\(1\) 随机关键点检测器在不使用点云中任何几何或颜色信息的情况下产生关键点。USIP探测器接收非彩色点云，并在3D空间(而不是在点云上选取已有的点)中提出候选兴趣位置。由两个检测器提出的关键点缺乏物理意义，并且在给定相同的输入时关键点具有随机性。

\(2\) SIFT-3D、ISS、Harris-3D和CED-3D只利用了几何信息，可以捕捉场景中的角点和边缘。ISS和CED-3D可以在炉子旋钮等几何显眼的位置生成稳定、规则的关键点。然而ISS在地板上产生许多毫无意义的关键点。CED-3D具有高度的规律性，并显示在平面表面是稳定的。

\(3\) Harris-6D和CED可以进一步利用彩色点云中的颜色信息。Harris-6D使用强度梯度计算显色性关键点，但在某种程度上是随机模式(部分Harris-6D关键点位于帧外)。相比之下，CED直接使用三维空间和色彩空间中的分布生成高度规则的几何和色彩显著的关键点，并且可以清晰地捕捉地砖之间的颜色变化。当需要时，这些常规关键点甚至可以作为几何任务中的边缘特征。这也是提高利用颜色信息的系统整体性能的关键。

<img src="https://img-blog.csdnimg.cn/4863afbcea02438aa39bbc11cfa65d4e.png" style="zoom:80%;" />

图4 针对Redwood Synthetic的定性比较。(a-f)仅能够提取几何显著关键点的方法。(g-h)能够提取几何和颜色显著关键点的方法。

### 4.3 可重复性

可重复性是指在各种干扰下提取相同关键点的能力。一个稳定的关键点检测器应该对平移、旋转和噪声具有不变性。具体来说，就是给定一个点云P，通过一个任意的变换矩阵T来获得点云Q，并在可以在Q中添加高斯噪声。然后在P和Q中提取关键点，分别得到关键点集KP和KQ。对于关键点pi∈KP，如果变换后的pi的几何分量和它的最近邻qj∈KQ之间的L2距离小于一个阈值，则称它为可重复的。。

按照上述步骤获得四个数据集的相对可重复性，结果如图5(a-h)所示。通过实现最高的相对可重复性，CED和CED-3D优于其他方法。在加入高斯噪声的情况下，CED和CED-3D对噪声具有鲁棒性，而其他方法的性能显著下降。

此外，还需要考虑在点云中提取关键点所需的运行时间，结果如图5(i-l)所示。CED和CED-3D平均计算量最小。随机关键点检测器实现了最快的运行时间，但它的可重复性接近于零。USIP关键点检测器需要的时间与CED和CED-3D相似，但它需要GPU进行计算，其可重复性明显低于CED和CED-3D。

<img src="https://img-blog.csdnimg.cn/7862f100805a4fd8b32b4cdaf62e9c22.png" style="zoom: 67%;" />

图5 无噪声添加(a-d)、有噪声添加(e-h)和运行时间(i-l)的评价结果

### 4.4 点云配准

为了验证所提出的CED关键点的有效性，作者进行了点云配准，包括以下4个步骤。1) 对于每一对从不同视点描述同一场景的点云，应用上述8个关键点检测器进行关键点提取。2) 使用PFHRGB描述子来描述关键点。3) 利用k-D树在特征向量空间中通过最近邻搜索建立对应关系。4) 给定已建立的对应关系，使用TEASER对齐两个点云。如果估计的变换与真值之间的平移误差小于0.2 m，旋转误差小于5 deg，则配准成功。

在Redwood Synthetic上的配准成功率如表2所示。CED在所有场景中都优于其他方法，并且CED-3D通过仅几何信息实现了较好性能。

表2 点云配准成功率

<img src="https://img-blog.csdnimg.cn/608c9fdb7021435c89d916c3141fa871.png"  />

### 4.5 消融研究

CED关键点检测器依赖于两个阈值参数，一个是到几何质心的距离，另一个是到光度质心的距离。几何阈值的范围为0到1，表示到形心的L2距离与球形邻域区域半径的比值。光度阈值的范围从0到3，表示颜色空间中的L1距离变化。表3所示是在Redwood Synthetic数据集上评估了当光度阈值固定为0.1时，几何阈值从0.1到0.5的情况，表4所是几何阈值固定为0.2时，光度阈值从0.1到0.5的情况。随着阈值的增加，提取的关键点数量减少。当tg=0.2，tc=0.5时，重复性最高。

表3 几何阈值消融实验

![](https://img-blog.csdnimg.cn/de0c9afcb10f457c9a993a8352dd6700.png)

表4 光度阈值消融实验

![](https://img-blog.csdnimg.cn/ee98b853d6484235a02726f8bb8f444d.png)

## 5. 结论

在2023 WACV论文"Centroid Distance Keypoint Detector for Colored Point Clouds"中，作者提出了一种质心距离(CED)关键点检测器，它可以利用彩色点云中的几何和颜色信息进行关键点检测。与最先进的手工和学习的关键点检测方法相比，CED有效、稳定且计算效率高。在三维重建、SLAM、点云配准等场合，应用CED可以取得较为不错的结果。
